<link rel="import" href="bower_components/paper-styles/shadow.html">
<link rel="import" href="bower_components/paper-styles/typography.html">
<link rel="import" href="bower_components/iron-input/iron-input.html">
<link rel="import" href="bower_components/iron-autogrow-textarea/iron-autogrow-textarea.html">

<dom-module id="event-planner">
  <template>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
        background-color: #fafafa;
        color: #212121;
        padding: 1em;
        @apply(--paper-font-common-base);
        @apply(--shadow-elevation-2dp);
        border-radius: 2px;
        --iron-autogrow-textarea: {
          margin: 0;
          padding: 0;
          font-family: 'Roboto Slab', Times New Roman, serif;
          white-space: pre-wrap;
        }
      }
      
      iron-autogrow-textarea {
        display: block;
        box-sizing: border-box;
        width: 100%;
        border: 0;
        margin: 1em 0 0;
        padding: 0;
        font-size: 0.9em;
        font-family: 'Roboto Slab', Times New Roman, serif;
      }
      .hidden {
        display: none;
      }
      h1 {
        font-size: 1.15em;
        margin: 0;
        white-space: pre-wrap;
      }
      h1:not(.hidden)+p {
        margin-top: 1em;
      }
      p {
        margin: 0;
        font-family: 'Roboto Slab', Times New Roman, serif;
        font-size: 0.9em;
        white-space: pre-wrap;
      }
      .placeholder:after {
        content: 'Tap to edit';
        opacity: 0.5;
      }
      .hidden {
        display: none;
      }
      .empty {
        font-style: italic;
        color: #737373;
        line-height: 0;
        pointer-events: none;
      }
      input {
        display: block;
        box-sizing: border-box;
        width: 100%;
        margin: 0;
        outline: none;
        border: 0;
        background: transparent;
        white-space: pre-wrap;
        font-family: 'Roboto', 'Noto', sans-serif;
        font-size: 1.15em;
        font-weight: bold;
        color: #212121;
      }

    </style>
    <template is="dom-if" if="[[editable]]">
      <paper-input 
       type="text" 
       id="event-title" 
       label="What's your event called?" 
       name="eventtitle"
       required
       minlength="3"
       auto-validate
       pattern="[a-zA-Z0-9\s*]*"
       error-message="Must be longer than 3 characters, be alphanumerical and spaces"
       placeholder="{{title}}" 
       bind-value="{{title}}">
      </paper-input>
      <paper-input
       type="text" 
       id="event-subtitle" 
       name="eventsubtitle"
       label="Enter the host's name (optional)" 
       placeholder="{{host}}" 
       bind-value="{{host}}">
      </paper-input>
      <paper-input
       type="text"
       id="event-type" 
       name="eventtype"
       required
       list="eventtypes"
       auto-validate
       min-length="3"
       pattern="[a-zA-Z\s*]*"
       error-message="Select an event type or enter an event type that can only contain letters and spaces"
       label="Select your event type" 
       placeholder="{{eventtype}}" 
       bind-value="{{eventtype}}">
      </paper-input>
      <datalist id="eventtypes">
        <option value="Birthday"></option>
        <option value="Corporate"></option>
        <option value="Personal"></option>
        <option value="Wedding"></option>
        <option value="Other"></option>
      </datalist>
      <paper-input
       type="datetime-local" 
       id="event-start" 
       name="eventstart"
       label="When is your event starting?" 
       required
       auto-validate
       pattern="^(([0]?[1-9]|1[0-2])/([0-2]?[0-9]|3[0-1])/[1-2]\d{3}) (20|21|22|23|[0-1]?\d{1}):([0-5]?\d{1})$"
       error-message="Please enter a valid date and time"
       placeholder="{{startdate}}" 
       bind-value="{{startdate}}">
      </paper-input>
      <paper-input
       type="datetime-local"
       id="event-end" 
       name="eventend"
       label="When is your event ending?" 
       required
       auto-validate
       pattern="^(([0]?[1-9]|1[0-2])/([0-2]?[0-9]|3[0-1])/[1-2]\d{3}) (20|21|22|23|[0-1]?\d{1}):([0-5]?\d{1})$"
       error-message="Please enter a valid date and time"
       placeholder="{{enddate}}" 
       bind-value="{{enddate}}">
      </paper-input>
      <paper-input
       type="text"
       onFocus="geolocate" 
       id="geo-address" 
       name="eventaddress"
       minlength="10"
       required
       auto-validate
       error-message="Please enter a valid address"
       label="Where will your event take place?" 
       placeholder="{{location}}" 
       bind-value="{{location}}">
      </paper-input>
      <paper-input
       type="text-area" 
       name="guestmessage"
       id="event-guest-message" 
       label="Enter a message for your guests (optional)" 
       placeholder="{{guestmessage}}" 
       bind-value="{{guestmessage}}">
      </paper-input>
      <paper-input
       type="text" 
       name="guestlist"
       id="event-guest-list" 
       label="Enter your guest names (optional)" 
       placeholder="{{guestlist}}" 
       bind-value="{{guestlist}}">
      </paper-input>
    </template>

    <!--  if is not editable-->
    <template is="dom-if" if="[[!editable]]">
      <h1 class$="[[emptyClass(title)]]">{{title}}</h1>
      <h2 class$="[[emptyClass(host)]]">{{host}}</h2>
      <p class$="[[emptyClass(eventtype)]]">{{eventtype}}</p>
      <p class$="[[emptyClass(startdate)]]">{{startdate}}</p>
      <p class$="[[emptyClass(enddate)]]">{{enddate}}</p>
      <p class$="[[emptyClass(location)]]">{{location}}</p>
    </template>

  </template>
  <script>
    Polymer({
      is: 'event-planner',
      properties: {
        editable: {
          type: Boolean,
          reflectToAttribute: true,
          value: false
        },
        title: {
          type: String,
          notify: true,
          value: ''
        },
        host: {
          type: String,
          notify: true,
          value: ''
        },
        eventtype: {
          type: String,
          notify: true,
          value: ''
        },
        startdate: {
          type: String,
          notify: true,
          value: ''
        },
        enddate: {
          type: String,
          notify: true,
          value: ''
        },
        location: {
          type: String,
          notify: true,
          value: ''
        },
        guestmessage: {
          type: String,
          notify: true,
          value: ''
        },
        guestlist: {
          type: String,
          notify: true,
          value: ''
        },
        lastUpdated: {
          type: Number,
          value: 0
        }
      },
      emptyClass : function (content) {
        return !content ? 'hidden' : '';
      },
      propertiesAreEmpty: function() {
        for (var i = 0; i < arguments.length; ++i) {
          if (arguments[i]) {
            return false;
          }
        }
        return true;
      }
    })
  </script>
</dom-module>